# ระบบจัดการบททดสอบแอดมิน (Admin Quiz System)

## ภาพรวม

ระบบจัดการบททดสอบแอดมินเป็นระบบที่พัฒนาขึ้นเพื่อให้ผู้ดูแลระบบสามารถสร้าง จัดการ และควบคุมเนื้อหาการเรียนการสอนได้อย่างมีประสิทธิภาพ ระบบรองรับการสร้างวิชาใหม่ บทเรียน และคำถามแบบไดนามิก

## คุณสมบัติหลัก

### 1. การสร้างบททดสอบ (AdminQuizCreationPage)
- **สร้างวิชาใหม่**: รองรับการสร้างวิชาใหม่ที่ไม่จำกัด เช่น คณิตศาสตร์ วิทยาศาสตร์ ภาษาไทย
- **สร้างบทเรียน**: สร้างบทเรียน L1, L2, L3 สำหรับแต่ละวิชา
- **สร้างคำถาม**: พิมพ์คำถามแบบหลายบรรทัด
- **ตัวเลือก**: สร้างตัวเลือก 4 ตัวเลือก (A, B, C, D)
- **เลือกคำตอบที่ถูกต้อง**: ใช้ Radio button เลือกคำตอบที่ถูกต้อง
- **การตรวจสอบ**: ตรวจสอบความถูกต้องของข้อมูลก่อนบันทึก

### 2. การจัดการบททดสอบ (AdminQuizManagementPage)
- **ดูรายการคำถาม**: แสดงคำถามทั้งหมดในบทเรียนที่เลือก
- **ตัวกรอง**: เลือกวิชาและบทเรียนเพื่อดูคำถาม
- **จัดการคำถาม**: แก้ไขและลบคำถาม
- **แสดงผล**: แสดงคำถามพร้อมตัวเลือกและคำตอบที่ถูกต้อง
- **แก้ไขบทเรียน**: แก้ไขเนื้อหาและลบ

### 3. แดชบอร์ดแอดมิน (AdminDashboardPage)
- **สถิติระบบ**: แสดงจำนวนวิชา บทเรียน และคำถามทั้งหมด
- **การดำเนินการด่วน**: ลิงก์ไปยังหน้าสร้างและจัดการคำถาม
- **วิชาล่าสุด**: แสดงวิชาที่สร้างล่าสุด
- **คำถามล่าสุด**: แสดงคำถามที่สร้างล่าสุด

### 4. ระบบวิชาแบบไดนามิก
- **วิชาใหม่**: วิชาที่สร้างใหม่จะปรากฏในหน้า main โดยอัตโนมัติ
- **โครงสร้าง**: รองรับโครงสร้างเดียวกับวิชาคอมพิวเตอร์และอิเล็กทรอนิกส์
- **การจัดการ**: จัดการวิชาและบทเรียนผ่าน Firebase

## โครงสร้างไฟล์

```
lib/
├── profile/
│   ├── admin_quiz_creation_page.dart      # หน้าสร้างบททดสอบ
│   ├── admin_quiz_management_page.dart    # หน้าจัดการบททดสอบ
│   ├── admin_dashboard_page.dart          # แดชบอร์ดแอดมิน
│   └── profile_page.dart                  # หน้าโปรไฟล์ (เพิ่มลิงก์แอดมิน)
├── subject/
│   ├── select_subject_page.dart           # หน้าเลือกวิชา (รองรับวิชาใหม่)
│   └── dynamic_subject_page.dart          # หน้าวิชาแบบไดนามิก
├── services/
│   └── firebase_utils.dart                # Firebase utilities (อัปเดต)
└── question/
    └── question_model.dart                # โมเดลคำถาม
```

## การใช้งาน

### สำหรับแอดมิน

1. **เข้าสู่ระบบแอดมิน**
   - ล็อกอินด้วยบัญชีแอดมิน
   - ไปที่หน้าโปรไฟล์
   - คลิก "แดชบอร์ดแอดมิน"

2. **สร้างวิชาใหม่**
   - ไปที่ "สร้างคำถาม"
   - เปิดสวิตช์ "วิชาใหม่"
   - ใส่ชื่อวิชาใหม่
   - เลือกบทเรียน
   - สร้างคำถามและบันทึก

3. **จัดการคำถาม**
   - ไปที่ "จัดการคำถาม"
   - เลือกวิชาและบทเรียน
   - ดู แก้ไข หรือลบคำถาม

### สำหรับผู้ใช้ทั่วไป

1. **เข้าถึงวิชาใหม่**
   - วิชาใหม่จะปรากฏในหน้า main โดยอัตโนมัติ
   - คลิกที่วิชาเพื่อเข้าสู่บทเรียน
   - ใช้งานเหมือนวิชาคอมพิวเตอร์และอิเล็กทรอนิกส์

## โครงสร้างฐานข้อมูล Firebase

```
subjects/
├── {subjectId}/
│   ├── title: String
│   ├── description: String
│   ├── image: String
│   ├── color: Number
│   ├── createdAt: Timestamp
│   ├── isActive: Boolean
│   ├── lessonCount: Number
│   └── questionCount: Number
│   └── lessons/
│       ├── L1/
│       │   ├── title: String
│       │   ├── intro: String
│       │   ├── image: String
│       │   ├── order: Number
│       │   ├── requiredStages: Number
│       │   ├── createdAt: Timestamp
│       │   ├── isActive: Boolean
│       │   └── questionCount: Number
│       │   └── questions/
│       │       ├── {questionId}/
│       │       │   ├── text: String
│       │       │   ├── options: Array<String>
│       │       │   ├── answerIndex: Number
│       │       │   ├── imageUrl: String?
│       │       │   ├── createdAt: Timestamp
│       │       │   ├── createdBy: String
│       │       │   └── isActive: Boolean
│       └── L2/
│       └── L3/
```

## การตั้งค่า

### 1. สิทธิ์แอดมิน
- ผู้ใช้ต้องมีสิทธิ์แอดมินในระบบ
- ตรวจสอบผ่าน `UserService.isAdmin(uid)`

### 2. Firebase Rules
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // อนุญาตให้แอดมินเข้าถึงทุกอย่าง
    match /subjects/{subjectId} {
      allow read: if true;
      allow write: if request.auth != null && 
        exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
        get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
  }
}
```

## การพัฒนาเพิ่มเติม

### 1. ฟีเจอร์ที่วางแผนไว้
- [ ] การแก้ไขคำถาม
- [ ] การจัดการรูปภาพ
- [ ] การนำเข้า/ส่งออกคำถาม
- [ ] รายงานสถิติการใช้งาน
- [ ] การจัดการผู้ใช้

### 2. การปรับปรุงประสิทธิภาพ
- [ ] การแคชข้อมูล
- [ ] การโหลดแบบ lazy loading
- [ ] การ optimize การ query Firebase

## การแก้ไขปัญหา

### 1. ปัญหาที่พบบ่อย
- **วิชาใหม่ไม่ปรากฏ**: ตรวจสอบการเชื่อมต่อ Firebase และสิทธิ์แอดมิน
- **ไม่สามารถบันทึกคำถาม**: ตรวจสอบการเชื่อมต่ออินเทอร์เน็ตและสิทธิ์แอดมิน
- **หน้าไม่โหลด**: ตรวจสอบ Firebase configuration

### 2. การ debug
- เปิด Developer Tools ใน Flutter
- ตรวจสอบ Console logs
- ตรวจสอบ Firebase Console

## การทดสอบ

### 1. การทดสอบฟังก์ชัน
- สร้างวิชาใหม่
- สร้างคำถาม
- จัดการคำถาม
- ลบคำถาม

### 2. การทดสอบสิทธิ์
- ล็อกอินด้วยบัญชีแอดมิน
- ล็อกอินด้วยบัญชีผู้ใช้ทั่วไป
- ตรวจสอบการเข้าถึงฟีเจอร์

## การติดตั้ง

### 1. Dependencies
```yaml
dependencies:
  flutter:
    sdk: flutter
  firebase_core: ^2.24.2
  firebase_auth: ^4.15.3
  cloud_firestore: ^4.13.6
  google_sign_in: ^6.1.6
```

### 2. Firebase Setup
- สร้างโปรเจกต์ Firebase
- เพิ่มแอป Android/iOS
- ดาวน์โหลด google-services.json
- ตั้งค่า Firebase Rules

## การสนับสนุน

หากพบปัญหาหรือต้องการความช่วยเหลือ:
1. ตรวจสอบไฟล์ log
2. ตรวจสอบ Firebase Console
3. ติดต่อทีมพัฒนา

## เวอร์ชัน

- **เวอร์ชันปัจจุบัน**: 1.0.0
- **วันที่อัปเดตล่าสุด**: 2024
- **ผู้พัฒนา**: TechWise Team

---

**หมายเหตุ**: ระบบนี้พัฒนาขึ้นเพื่อการศึกษาและการเรียนรู้ โปรดใช้อย่างเหมาะสมและตามวัตถุประสงค์ที่กำหนด

